(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{358:function(s,n,a){"use strict";a.r(n);var t=a(7),e=Object(t.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h4",{attrs:{id:"指标"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#指标"}},[s._v("#")]),s._v(" 指标")]),s._v(" "),n("ol",[n("li",[n("p",[s._v("QPS：每秒请求数")])]),s._v(" "),n("li",[n("p",[s._v("TPS：每秒事务数，一个事务可能会包含多个请求，比如一个页面加载会发送多个请求至后端")])]),s._v(" "),n("li",[n("p",[s._v("RT：系统响应时间，执行一个请求从开始到最后收到响应数据所花费的总体时间")])]),s._v(" "),n("li",[n("p",[s._v("Concurrency：并发数，系统同时处理的请求数量，也反应了系统的负载能力")])]),s._v(" "),n("li",[n("p",[s._v("吞吐量：系统吞吐量和CPU消耗、外部接口、IO等因素等紧密关联。")]),s._v(" "),n("p",[s._v("重要指标参数：QPS（TPS）、并发数、平均响应时间")])])]),s._v(" "),n("p",[s._v("关系：\n$$\nQPS(TPS) = 并发数 / 平均响应时间\n$$")]),s._v(" "),n("h4",{attrs:{id:"qps压测实验"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#qps压测实验"}},[s._v("#")]),s._v(" QPS压测实验")]),s._v(" "),n("p",[s._v("压测工具：wrk")]),s._v(" "),n("p",[s._v("环境：ubuntu（wsl subSystem), 6核 11线程")]),s._v(" "),n("p",[s._v("并发200测试")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("root@LAPTOP-6HNUFCIN:/usr/bin"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# wrk -t 11 -c 200 -d 30s --latency  http://127.0.0.1:8281/api/test")]),s._v("\nRunning 30s "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" @ http://127.0.0.1:8281/api/test\n  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" threads and "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),s._v(" connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("43")]),s._v(".81ms   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("26")]),s._v(".20ms "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("259")]),s._v(".14ms   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("69.79")]),s._v("%\n    Req/Sec   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("419.92")]),s._v("     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("56.97")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("680.00")]),s._v("     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("68.39")]),s._v("%\n  Latency Distribution\n     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("%   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("44")]),s._v(".25ms\n     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("75")]),s._v("%   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v(".54ms\n     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("90")]),s._v("%   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("76")]),s._v(".10ms\n     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("99")]),s._v("%  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("109")]),s._v(".90ms\n  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("138097")]),s._v(" requests "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(".05s, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("40")]),s._v(".98MB "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("read")]),s._v("\n  Non-2xx or 3xx responses: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("138097")]),s._v("\nRequests/sec:   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4596.04")]),s._v(" //QPS\nTransfer/sec:      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".36MB\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("p",[s._v("avgRT为43ms，则在1s单位时间内，能串行处理23个请求。因此QPS = 23 * 200 = 4600个，和测试结果差不多。但在真实环境应该会更低。")]),s._v(" "),n("p",[s._v("并发300测试")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("root@LAPTOP-6HNUFCIN:/usr/bin"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# wrk -t 11 -c 300 -d 30s --latency  http")]),s._v("\n://127.0.0.1:8281/api/test\nRunning 30s "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" @ http://127.0.0.1:8281/api/test\n  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" threads and "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("300")]),s._v(" connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("63")]),s._v(".50ms   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("35")]),s._v(".50ms "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("358")]),s._v(".22ms   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("58.62")]),s._v("%\n    Req/Sec   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("432.67")]),s._v("     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("56.40")]),s._v("     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".92k    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("69.47")]),s._v("%\n  Latency Distribution\n     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("%   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(".55ms\n     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("75")]),s._v("%   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("87")]),s._v(".37ms\n     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("90")]),s._v("%  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("108")]),s._v(".46ms\n     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("99")]),s._v("%  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("155")]),s._v(".62ms\n  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("142058")]),s._v(" requests "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(".03s, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("42")]),s._v(".16MB "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("read")]),s._v("\n  Non-2xx or 3xx responses: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("142058")]),s._v("\nRequests/sec:   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4729.85")]),s._v("\nTransfer/sec:      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".40MB\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("p",[s._v("增加并发数QPS基本保持不变，验证了"),n("code",[s._v("QPS(TPS) = 并发数 / 平均响应时间")])])])}),[],!1,null,null,null);n.default=e.exports}}]);