(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{399:function(t,a,e){"use strict";e.r(a);var r=e(4),s=Object(r.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h4",{attrs:{id:"调优原则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#调优原则"}},[t._v("#")]),t._v(" 调优原则")]),t._v(" "),a("p",[t._v("JVM调优不是常规手段，性能问题一般第一选择是优化程序，最后的选择才是进行JVM调优。")]),t._v(" "),a("h4",{attrs:{id:"调优时机"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#调优时机"}},[t._v("#")]),t._v(" 调优时机")]),t._v(" "),a("ul",[a("li",[t._v("Heap内存（老年代）持续上涨达到设置的最大内存值；")]),t._v(" "),a("li",[t._v("Full GC 次数频繁；")]),t._v(" "),a("li",[t._v("GC 停顿时间过长（超过1秒）；")]),t._v(" "),a("li",[t._v("应用出现OutOfMemory 等内存异常；")]),t._v(" "),a("li",[t._v("应用中有使用本地缓存且占用大量内存空间；")]),t._v(" "),a("li",[t._v("系统吞吐量与响应性能不高或下降。")])]),t._v(" "),a("h4",{attrs:{id:"调优指标"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#调优指标"}},[t._v("#")]),t._v(" 调优指标")]),t._v(" "),a("ul",[a("li",[t._v("延迟：GC低停顿和GC低频率")]),t._v(" "),a("li",[t._v("低内存占用")]),t._v(" "),a("li",[t._v("高吞吐量")])]),t._v(" "),a("p",[t._v("三者不可兼得，任何一个属性提高，几乎是于其他属性的性能损失为代价")]),t._v(" "),a("h4",{attrs:{id:"调优步骤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#调优步骤"}},[t._v("#")]),t._v(" 调优步骤")]),t._v(" "),a("p",[t._v("一般情况下，JVM调优可通过以下步骤进行：")]),t._v(" "),a("ul",[a("li",[t._v("分析GC日志及dump文件，判断是否需要优化，确定瓶颈问题点；")]),t._v(" "),a("li",[t._v("确定JVM调优量化目标；")]),t._v(" "),a("li",[t._v("确定JVM调优参数（根据历史JVM参数来调整）；")]),t._v(" "),a("li",[t._v("依次调优内存、延迟、吞吐量等指标；")]),t._v(" "),a("li",[t._v("对比观察调优前后的差异；")]),t._v(" "),a("li",[t._v("不断的分析和调整，直到找到合适的JVM参数配置；")]),t._v(" "),a("li",[t._v("找到最合适的参数，将这些参数应用到所有服务器，并进行后续跟踪。")])]),t._v(" "),a("h4",{attrs:{id:"jvm参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jvm参数"}},[t._v("#")]),t._v(" JVM参数")]),t._v(" "),a("p",[t._v("一般调优都是调整JVM堆参数")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/soda1/img/main/20230312025734.png",alt:""}})]),t._v(" "),a("p",[a("strong",[t._v("1.8版本")])]),t._v(" "),a("p",[t._v("在1.8版本中Permanent generation已经被Meta space替换了，Meta space参数如下")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("参数名称")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("含义")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("-XX:MetaspaceSize")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("初始元空间大小")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("-XX:MaxMetaspaceSize")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("最大元空间")])])])]),t._v(" "),a("p",[a("strong",[t._v("语法规则")])]),t._v(" "),a("p",[t._v("布尔类型参数值：")]),t._v(" "),a("ul",[a("li",[t._v("-XX:+ '+'表示启用该选项")]),t._v(" "),a("li",[t._v("-XX:- '-'表示关闭该选项")])]),t._v(" "),a("p",[t._v("数字类型参数值：")]),t._v(" "),a("ul",[a("li",[t._v("-XX:=给选项设置一个数字类型值，可跟随单位，例如：'m'或'M'表示兆字节;'k'或'K'千字节;'g'或'G'千兆字节。32K与32768是相同大小的。")])]),t._v(" "),a("p",[t._v("字符串类型参数值：")]),t._v(" "),a("ul",[a("li",[t._v("-XX:=给选项设置一个字符串类型值，通常用于指定一个文件、路径或一系列命令列表。例如：-XX:HeapDumpPath=./dump.core")])]),t._v(" "),a("p",[t._v("示例：")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("java")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-Xmx4g")]),t._v(" –Xms4g –Xmn1200m –Xss512k "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:NewRatio")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:SurvivorRatio")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:PermSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("100m "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:MaxPermSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("256m "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:MaxTenuringThreshold")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-jar")]),t._v(" xxx.jar\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h4",{attrs:{id:"性能监控工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#性能监控工具"}},[t._v("#")]),t._v(" 性能监控工具")]),t._v(" "),a("p",[a("strong",[t._v("JDK自带工具")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/soda1/img/main/20230312031532.png",alt:""}})]),t._v(" "),a("p",[t._v("Linux命令行工具")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("命令")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("top")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("实时显示正在执行进程的 CPU 使用率、内存使用率以及系统负载等信息")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("vmstat")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("对操作系统的虚拟内存、进程、CPU活动进行监控")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("pidstat")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("监控指定进程的上下文切换")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("iostat")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("监控磁盘IO")])])])]),t._v(" "),a("p",[t._v("参考：")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://www.alibabacloud.com/blog/how-to-properly-plan-jvm-performance-tuning_594663",title:"How to Properly Plan JVM Performance Tuning",target:"_blank",rel:"noopener noreferrer"}},[t._v("How to Properly Plan JVM Performance Tuning"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"https://cloud.tencent.com/developer/article/1812722",title:"JVM调优总结",target:"_blank",rel:"noopener noreferrer"}},[t._v("JVM调优总结"),a("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=s.exports}}]);