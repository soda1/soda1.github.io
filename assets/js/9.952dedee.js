(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{366:function(e,t,n){"use strict";n.r(t);n(98);var i=n(337),o=n.n(i),a=n(339),r=n.n(a),l={data:()=>({count:0,objId:""}),mounted(){"/"!=this.$route.path&&this.initPageInfo()},watch:{$route(e,t){"/"!==e.path&&e.path!==t.path&&this.$themeConfig.blogInfo&&this.initPageInfo()}},methods:{initPageInfo(){if(null==this.$frontmatter.article||this.$frontmatter.article){const{eachFileWords:e,pageView:t,pageIteration:n,readingTime:i}=this.$themeConfig.blogInfo;if(e)try{e.forEach(e=>{if(e.permalink==this.$frontmatter.permalink)throw this.addPageWordsCount(e.wordsCount),(i||null==i)&&this.addReadTimeCount(e.readingTime),new Error})}catch(e){}(t||null==t)&&this.getPageViewCount()}else;},postCount(){const e={ACL:{"*":{read:!0,write:!0}},url:location.pathname,xid:location.pathname,title:"",time:1};r.a.request({method:"post",url:this.$themeConfig.pageViewCountUrl,data:JSON.stringify(e),headers:{"x-lc-id":"1nUJQZbgj4hBNA12QWafid7t-MdYXbMMI","x-lc-sign":this.getSignature(),"content-type":"application/json;charset=UTF-8"}})},getSignature(){const e=Date.now(),t=new Date(e).getTime()+60*(new Date).getTimezoneOffset()*1e3,n=t+"qr99wkWG575YMDYBqysXZxHj";return o()(n)+","+t},atomicUpdateCount(e){r()({method:"put",url:this.$themeConfig.pageViewCountUrl+"/"+e,data:JSON.stringify({time:{__op:"Increment",amount:1}}),headers:{"x-lc-id":"1nUJQZbgj4hBNA12QWafid7t-MdYXbMMI","x-lc-sign":this.getSignature(),"content-type":"application/json;charset=UTF-8"}})},async getPageViewCount(){const e={url:location.pathname};console.log(e);const t=encodeURIComponent(JSON.stringify(e));this.count=0,await r.a.request({method:"get",url:this.$themeConfig.pageViewCountUrl+"?where="+t,data:{},headers:{"x-lc-id":"1nUJQZbgj4hBNA12QWafid7t-MdYXbMMI","x-lc-sign":this.getSignature()}}).then(e=>{const t=e.data;t.results&&t.results.length>0?(this.objId=t.results[0].objectId,this.count=t.results[0].time,this.atomicUpdateCount(this.objId)):this.postCount()}).catch(e=>{console.log("get pageViewCount error")}),this.addPageView()},addPageView(){let e=document.querySelector(".page-view");if(e)e.innerHTML='<i class="leancloud-visitors-count">'+this.count+"</i>";else{let e=document.createElement("div");console.log(location.pathname),e.title="浏览量",e.id=location.pathname,e.className="page-view iconfont icon-view",e.style.float="left",e.style.marginLeft="20px",e.style.fontSize="0.8rem",e.innerHTML='<i class="leancloud-visitors-count">'+this.count+"</i>";let t=document.createElement("style");t.innerHTML="@keyframes turn {\n        0% {\n          transform: rotate(0deg);\n        }\n        100% {\n          transform: rotate(360deg);\n        }\n      }\n      .loading {\n        display: inline-block;\n        animation: turn 1s linear infinite;\n        -webkit-animation: turn 1s linear infinite;\n      }",document.head.appendChild(t),this.mountedView(e)}},addPageWordsCount(e=0){let t=document.querySelector(".book-words");if(t)t.innerHTML=`<a href="javascript:;" style="margin-left: 3px; color: #888">${e}</a>`;else{let t=document.createElement("div");t.title="文章字数",t.className="book-words iconfont icon-book",t.style.float="left",t.style.marginLeft="20px",t.style.fontSize="0.8rem",t.innerHTML=`<a href="javascript:;" style="margin-left: 3px; color: #888">${e}</a>`,this.mountedView(t)}},addReadTimeCount(e=0){let t=document.querySelector(".reading-time");if(t)t.innerHTML=`<a href="javascript:;" style="margin-left: 3px; color: #888">${e}</a>`;else{let t=document.createElement("div");t.title="预阅读时长",t.className="reading-time iconfont icon-shijian",t.style.float="left",t.style.marginLeft="20px",t.style.fontSize="0.8rem",t.innerHTML=`<a href="javascript:;" style="margin-left: 3px; color: #888">${e}</a>`,this.mountedView(t)}},mountedView(e,t=100,n=".articleInfo-wrap > .articleInfo > .info"){let i=document.querySelector(n);if(i)this.isMountedView(e,i)||i.appendChild(e);else{let o=setInterval(()=>{i=document.querySelector(n),i&&(this.isMountedView(e,i)||(i.appendChild(e),clearInterval(o)))},t);this.$once("hook:beforeDestroy",()=>{clearInterval(o),o=null})}},removeElement(e){var t=document.querySelector(e);t&&t.parentNode.removeChild(t)},isMountedView:(e,t)=>e.parentNode==t},beforeMount(){clearInterval(this.interval),this.removeElement(".page-view"),this.removeElement(".book-words"),this.removeElement(".reading-time")}},s=n(4),c=Object(s.a)(l,(function(){return(0,this._self._c)("div")}),[],!1,null,null,null);t.default=c.exports}}]);